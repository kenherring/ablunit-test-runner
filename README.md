# ABLUnit Test Provider [![CircleCI](https://img.shields.io/circleci/build/github/kenherring/ablunit-test-provider/main)](https://dl.circleci.com/status-badge/redirect/gh/kenherring/ablunit-test-provider/tree/main) [![Maintainability Rating](https://sonarcloud.io/api/project_badges/measure?project=kenherring_ablunit-test-provider&metric=sqale_rating)](https://sonarcloud.io/summary/new_code?id=kenherring_ablunit-test-provider)

This VSCode test provider extension integrates [ABLUnit tests](https://docs.progress.com/bundle/openedge-developer-studio-help-122/page/Learn-About-ABLUnit-Test-Framework.html) into the VSCode test explorer.

This is my first VSCode extension, and my first TypeScript project. I'm sure there are many ways to improve the code, and I welcome any feedback.  I'm also open to collaboration if anyone is interested.

Quality code, and thus unit testing, is a passion of mine.  I hope this extension helps others to embrace [TDD](https://en.wikipedia.org/wiki/Test-driven_development) and improve their code.

## OpenEdge Versions Note

This project was developed using the [Progress OpenEdge Developers Kit: Classroom Edition](https://www.progress.com/openedge/classroom-edition).  That means it's only been tested against version 12.2 at the moment.  Feel free to report any bugs you may run into with other versions.

## Extension

### Features

* Run ABLUnit Tests
* See test results
* View code coverage

	![code coverage](docs/coverage.png)

## Configuration

| Setting | Default | Description |
| --- | --- | --- |
| `ablunit.display.classLabel` | `classname` | `[ "classname" \| "filename" ]` |
| `ablunit.display.style` | `tree` | `[ "tree" \| "flat" ]` |
| `ablunit.files.include` | `**/*.{cls,p}` | Glob pattern to identify potential tests |
| `ablunit.files.exclude` | `**/.builder/**` | Glob pattern to exclude |
| `ablunit.findAllFilesAtStartup` | `true` | Search all workspace files for test cases.  It may be beneficial to disable this for large workspaces, in which case the extension will find tests as files are accessed. |
| `ablunit.importOpenedgeProjectJson` | `false` | import settings from `openedge-project.json` |
| `ablunit.notificationsEnabled` | `true` | Enable/disable notifications |
| `ablunit.params` | | Additional options/parameters passed to `_progres` |
| `ablunit.progressIniPath` | | Path to a `progress.ini` file to use |
| `ablunit.tempDir` | Extension storage area | Any files generated when running ABLUnit will be stored here.  It is also used for the [`-T`](https://docs.progress.com/bundle/openedge-startup-and-parameter-reference-122/page/Temporary-Directory-T.html) startup parameter |
| `ablunit.tests.command` | `_progres -b -p ABLUnitCore.p <...>` | This setting can be used to run tests with any existing shell command your tests are configured to run with.  Example: `ant test` |
| `ablunit.tests.command.useABLPluginCommand` | | Use this command to run tests from the CLI |
| `ablunit.tests.task` | | Use this task to run tests via VSCode |
| `ablunit.configJson.configJson.configPath` | | |
| `ablunit.configJson.configJson.outputPath` | | Output location for the xml generated by ABLUnit.  Typically `results.xml`.  This setting would typically be used with `ablunit.tests.command` |
| `ablunit.configJson.configJson.outputWriteJson` | | |
| `ablunit.configJson.configJson.quitOnEnd` | | |
| `ablunit.configJson.configJson.writeLog` | | |
| `ablunit.configJson.configJson.showErrorMessage` | | |
| `ablunit.configJson.configJson.throwError` | | |
| `ablunit.profilerOptions.optionsPath` | | See the [`-profile`](https://docs.progress.com/bundle/openedge-startup-and-parameter-reference-122/page/Profiler-profile.html) startup parameter |
| `ablunit.profilerOptions.enabled` | | |
| `ablunit.profilerOptions.description` | | |
| `ablunit.profilerOptions.filename` | | |
| `ablunit.profilerOptions.listings` | | |
| `ablunit.profilerOptions.statistics` | | |
| `ablunit.profilerOptions.traceFilter` | | |
| `ablunit.profilerOptions.tracing` | | |
| `ablunit.profilerOptions.writeJson` | | |

## Contributing

### Running the Project

- Run `npm install` in terminal to install dependencies
- Run the `Run Extension` target in the Debug View. This will:
	- Start a task `npm: watch` to compile the code
	- Run the extension in a new VS Code window
- Run a test in the new VS Code window

## Links

* [Progress Documentation -> Progress Developer Studio for OpenEdge Online Help -> Run test cases from the command prompt](https://docs.progress.com/bundle/openedge-developer-studio-help/page/Run-test-cases-from-the-command-prompt.html)
* [Progress Documentation -> ABLUnit Annotations](// https://docs.progress.com/bundle/openedge-developer-studio-olh-117/page/Annotations-supported-with-ABLUnit.html) - Used w/ snippets
* [GitHub progress/ade](https://github.com/progress/ADE) - source files for OE code
