# ABLUnit Test Provider [![CircleCI](https://img.shields.io/circleci/build/github/kenherring/ablunit-test-provider/main?logo=circleci)](https://dl.circleci.com/status-badge/redirect/gh/kenherring/ablunit-test-provider/tree/main) [![Maintainability Rating](https://sonarcloud.io/api/project_badges/measure?project=kenherring_ablunit-test-provider&metric=sqale_rating)](https://sonarcloud.io/summary/new_code?id=kenherring_ablunit-test-provider)

This VSCode test provider extension integrates [ABLUnit tests](https://docs.progress.com/bundle/openedge-developer-studio-help-122/page/Learn-About-ABLUnit-Test-Framework.html) into the VSCode test explorer.

This is my first VSCode extension, and my first TypeScript project. I'm sure there are many ways to improve the code, and I welcome any feedback.  I'm also open to collaboration if anyone is interested.

Quality code, and thus unit testing, is a passion of mine.  I hope this extension helps others to embrace [TDD](https://en.wikipedia.org/wiki/Test-driven_development) and improve their code.

## OpenEdge Versions Note

This project was developed using the [Progress OpenEdge Developers Kit: Classroom Edition](https://www.progress.com/openedge/classroom-edition).  That means it's only been tested against version 12.2 at the moment.  Feel free to report any bugs you may run into with other versions.

## Extension

### Features

* Run ABLUnit Tests
* See test results
* View code coverage

	![code coverage](https://github.com/kenherring/ablunit-test-provider/raw/main/docs/coverage.png)

## Configuration

| Setting | Default | Description |
| --- | --- | --- |
| `ablunit.display.classLabel` | `classname` | `[ "classname" \| "filename" ]` |
| `ablunit.files.include` | `[ "**/*.{cls,p}" ]` | Glob pattern array to include test files |
| `ablunit.files.exclude` | `[ "**/.builder/**" ]` | Glob pattern array to exclude test files |
| `ablunit.findAllFilesAtStartup` | `true` | Search all workspace files for test cases.  It may be beneficial to disable this for large workspaces, in which case the extension will find tests as files are accessed. |
| `ablunit.importOpenedgeProjectJson` | `false` | import settings from `openedge-project.json` |
| `ablunit.notificationsEnabled` | `true` | Enable/disable notifications |
| `ablunit.params` | | Additional options/parameters passed to `_progres` |
| `ablunit.progressIniPath` | | Path to a `progress.ini` file to use |
| `ablunit.tempDir` | Extension storage area | Any files generated when running ABLUnit will be stored here.  It is also used for the [`-T`](https://docs.progress.com/bundle/openedge-startup-and-parameter-reference-122/page/Temporary-Directory-T.html) startup parameter |
| `ablunit.tests.command` | `_progres -b -p ABLUnitCore.p <...>` | This setting can be used to run tests with any existing shell command your tests are configured to run with.  Example: `ant test` |
| `ablunit.tests.task` | | Use this task to run tests via VSCode |
| `ablunit.configJson.configPath` | `ablunit.json` | |
| `ablunit.configJson.outputLocation` | `results.xml` | Output location for the xml generated by ABLUnit.  Typically used with `ablunit.tests.command` |
| `ablunit.configJson.outputWriteJson` | | Output `results.json` version of `results.xml` after analysis |
| `ablunit.configJson.quitOnEnd` | | |
| `ablunit.configJson.writeLog` | | |
| `ablunit.configJson.showErrorMessage` | | |
| `ablunit.configJson.throwError` | | |
| `ablunit.profilerOptions.optionsPath` | `profile.options` | See the [`-profile`](https://docs.progress.com/bundle/openedge-startup-and-parameter-reference-122/page/Profiler-profile.html) startup parameter |
| `ablunit.profilerOptions.enabled` | `true` | Enable the profiler |
| `ablunit.profilerOptions.description` | `Unit Tests Run via ABLUnit Test Runner (VSCode)| |
| `ablunit.profilerOptions.filename` | `prof.out` | |
| `ablunit.profilerOptions.listings` | `false`` | |
| `ablunit.profilerOptions.statistics` | `false` | |
| `ablunit.profilerOptions.traceFilter` | | |
| `ablunit.profilerOptions.tracing` | | |
| `ablunit.profilerOptions.writeJson` | | Output a json formatted version of the profiler output.  Filepath is the same as `abluint.profilerOptions.filename` with `json` extension. |
<!-- | `ablunit.tests.command.useABLPluginCommand` | | Use this command to run tests from the CLI | -->

## Contributing

### Running the Project

- Run `npm install` in terminal to install dependencies
- Run the `Run Extension` target in the Debug View. This will:
	- Start a task `npm: watch` to compile the code
	- Run the extension in a new VS Code window
- Run a test in the new VS Code window

### Testing the Project

* Using the CLI: `npm test`
* Using the native VSCode API:  install the [Extension Test Runner](https://marketplace.visualstudio.com/items?itemName=ms-vscode.extension-test-runner) extension
* Using docker:
    ```bash
	docker/docker_build.sh # run once to build the container
	docker/run_tests.sh
	```

## Links

* [VSCode Marketplace - ABLUnit Test Runner](https://marketplace.visualstudio.com/items?itemName=kherring.ablunit-test-provider)
* Progress Documentation
  * [Run test cases from the command prompt](https://docs.progress.com/bundle/openedge-developer-studio-help/page/Run-test-cases-from-the-command-prompt.html)
  * [Learn About ABLUnit Test Framework](https://docs.progress.com/bundle/openedge-developer-studio-help/page/Learn-About-ABLUnit-Test-Framework.html)
  * [ABLUnit Annotations](https://docs.progress.com/bundle/openedge-developer-studio-help/page/Annotations-supported-with-ABLUnit.html)
* [GitHub progress/ade](https://github.com/progress/ADE) - source files for OE code

## Badges

[![CircleCI](https://img.shields.io/circleci/build/github/kenherring/ablunit-test-provider/main?logo=circleci)](https://dl.circleci.com/status-badge/redirect/gh/kenherring/ablunit-test-provider/tree/main)


[![Quality Gate Status](https://sonarcloud.io/api/project_badges/measure?project=kenherring_ablunit-test-provider&metric=alert_status)](https://sonarcloud.io/summary/new_code?id=kenherring_ablunit-test-provider)

[![Maintainability Rating](https://sonarcloud.io/api/project_badges/measure?project=kenherring_ablunit-test-provider&metric=sqale_rating)](https://sonarcloud.io/summary/new_code?id=kenherring_ablunit-test-provider)

[![Coverage](https://sonarcloud.io/api/project_badges/measure?project=kenherring_ablunit-test-provider&metric=coverage)](https://sonarcloud.io/summary/new_code?id=kenherring_ablunit-test-provider)
